---
// Esta p√°gina se renderiza din√°micamente en el servidor
export const prerender = false;

import Layout from '../../layouts/Layout.astro';
import { getDiagnosticResult } from '../../utils/backendClient';
import CostSummarySection from '../../components/diagnostic/CostSummarySection.astro';
import CurrentSituationSection from '../../components/diagnostic/CurrentSituationSection.astro';
import OpportunitiesSection from '../../components/diagnostic/OpportunitiesSection.astro';
import DiagnosticResultClient from '../../components/DiagnosticResultClient';
import { 
  getCurrentSituationImageUrl, 
  getOpportunityImageUrl, 
  getOperationalImpactImageUrl, 
  getFutureVisionImageUrl, 
  getSummaryImageUrl,
  getOpportunitySectionImageUrl,
  getInsightImageUrl
} from '../../utils/getResultImageUrl';
import type { BusinessSector } from '../../utils/conversationalDiagnostic';
import { getServiceById, getRecommendedServicesForSector, getServicePageForExtendedType, type Service } from '../../utils/services';

interface Props {
  id: string;
}

// Obtener el ID del par√°metro de ruta
const { id } = Astro.params;

let diagnosticResult = null;
let diagnosticData = null;
let error = null;
let contactName = '';
let contactCompany = '';

try {
  if (!id) {
    throw new Error('ID de diagn√≥stico no proporcionado');
  }

  console.log('üîç Loading diagnostic with ID:', id);
  
  // Si el ID comienza con "local-", marcar para cargar desde localStorage en el cliente
  // El servidor no puede leer sessionStorage, as√≠ que siempre marcamos para carga en cliente
  if (id.startsWith('local-')) {
    console.log('üì¶ [RESULT PAGE] Will load from localStorage in client');
    // En el cliente, leer desde localStorage
    // Por ahora, marcar que debe leerse en el cliente
    diagnosticResult = { _loadFromLocalStorage: true, _id: id };
  } else {
    // Intentar obtener el resultado procesado del backend
    try {
      const response = await getDiagnosticResult(id);
      console.log('üì• Response from getDiagnosticResult:', response);
      console.log('üì• Response.data keys:', response.data ? Object.keys(response.data) : 'NO DATA');
      
      if (response.success && response.data) {
        diagnosticResult = response.data;
    console.log('‚úÖ Diagnostic result loaded:', diagnosticResult);
    console.log('‚úÖ Diagnostic result keys:', Object.keys(diagnosticResult));
    console.log('‚úÖ Diagnostic result type:', diagnosticResult.type);
    console.log('‚úÖ Full diagnostic result:', JSON.stringify(diagnosticResult, null, 2));
    console.log('üîç [RESULT PAGE] Sector:', diagnosticResult?.sector);
    console.log('üîç [RESULT PAGE] Type:', diagnosticResult?.type);
    
    // Verificar estructura mejorada
    console.log('üîç [RESULT PAGE] Has currentSituation:', !!diagnosticResult.currentSituation);
    console.log('üîç [RESULT PAGE] Has opportunities:', !!diagnosticResult.opportunities, 'Count:', diagnosticResult.opportunities?.length || 0);
    console.log('üîç [RESULT PAGE] Has operationalImpact:', !!diagnosticResult.operationalImpact);
    console.log('üîç [RESULT PAGE] Has futureVision:', !!diagnosticResult.futureVision);
    console.log('üîç [RESULT PAGE] Has summary:', !!diagnosticResult.summary);
    
    // Verificar imageUrls
    if (diagnosticResult.currentSituation) {
      console.log('üñºÔ∏è [RESULT PAGE] currentSituation.imageUrl:', diagnosticResult.currentSituation.imageUrl || 'MISSING');
    }
    if (diagnosticResult.summary) {
      console.log('üñºÔ∏è [RESULT PAGE] summary.imageUrl:', diagnosticResult.summary.imageUrl || 'MISSING');
    }
    if (diagnosticResult.opportunities && diagnosticResult.opportunities.length > 0) {
      console.log('üñºÔ∏è [RESULT PAGE] Opportunities imageUrls:', diagnosticResult.opportunities.map((opp: any) => ({ 
        title: opp.title, 
        imageUrl: opp.imageUrl || 'MISSING',
        willGenerate: !opp.imageUrl 
      })));
    }
    if (diagnosticResult.operationalImpact?.consequences && diagnosticResult.operationalImpact.consequences.length > 0) {
      console.log('üñºÔ∏è [RESULT PAGE] Consequences imageUrls:', diagnosticResult.operationalImpact.consequences.map((c: any) => ({ 
        area: c.area, 
        imageUrl: c.imageUrl || 'MISSING',
        willGenerate: !c.imageUrl 
      })));
    }
    if (diagnosticResult.futureVision) {
      console.log('üñºÔ∏è [RESULT PAGE] futureVision.imageUrl:', diagnosticResult.futureVision.imageUrl || 'MISSING');
    }
    
    // Tambi√©n obtener los datos del diagn√≥stico para informaci√≥n de contacto
    // Detectar la URL del backend seg√∫n el entorno
    const getBackendUrl = () => {
      if (import.meta.env.PUBLIC_BACKEND_URL) {
        return import.meta.env.PUBLIC_BACKEND_URL;
      }
      if (import.meta.env.DEV) {
        return 'http://localhost:3000';
      }
      // En producci√≥n, usar la misma URL base
      return typeof window !== 'undefined' ? window.location.origin : 'http://localhost:3000';
    };
    const backendUrl = getBackendUrl();
    console.log('üîç Fetching diagnostic data from:', `${backendUrl}/api/diagnostic/${id}`);
    
    const diagnosticResponse = await fetch(
      `${backendUrl}/api/diagnostic/${id}`
    );
    
    console.log('üì• Diagnostic data response status:', diagnosticResponse.status);
    
    if (diagnosticResponse.ok) {
      const diagnosticResponseData = await diagnosticResponse.json();
      console.log('üì• Diagnostic data response:', diagnosticResponseData);
      
      if (diagnosticResponseData.success) {
        diagnosticData = diagnosticResponseData.data;
        contactName = diagnosticData.nombre || '';
        contactCompany = diagnosticData.empresa || '';
        console.log('‚úÖ Contact info loaded:', { contactName, contactCompany });
      }
    } else {
      console.warn('‚ö†Ô∏è  Could not fetch diagnostic data for contact info');
    }
    
    // Calcular summaryImageUrl si existe summary
    if (diagnosticResult.summary) {
      const sector = (diagnosticResult?.sector || 'restaurante') as BusinessSector;
      let summaryImageUrl = diagnosticResult.summary.imageUrl;
      
      // Corregir may√∫sculas en beforeAfter -> beforeafter para compatibilidad con diagn√≥sticos antiguos
      if (summaryImageUrl && summaryImageUrl.includes('beforeAfter')) {
        summaryImageUrl = summaryImageUrl.replace('beforeAfter', 'beforeafter');
      }
      
      // Si no hay imageUrl, generarlo usando la funci√≥n de utilidad
      if (!summaryImageUrl) {
        summaryImageUrl = getSummaryImageUrl(sector, 'beforeAfter');
        console.log('üîÑ [RESULT PAGE] Generated summary imageUrl:', summaryImageUrl);
      }
      
      // Agregar el imageUrl calculado al objeto summary
      diagnosticResult.summary.imageUrl = summaryImageUrl;
    }
      } else {
        console.error('‚ùå Response not successful:', response);
        // Si falla el backend, intentar localStorage como fallback
        diagnosticResult = { _loadFromLocalStorage: true, _id: id };
      }
    } catch (backendError: any) {
      console.warn('‚ö†Ô∏è [RESULT PAGE] Backend not available, trying localStorage:', backendError);
      // Si el backend no est√° disponible, intentar localStorage
      diagnosticResult = { _loadFromLocalStorage: true, _id: id };
    }
  }
  
  // Asegurar que diagnosticResult tenga nextSteps y urgency si existe y no es placeholder
  if (diagnosticResult && !diagnosticResult._loadFromLocalStorage) {
    if (!diagnosticResult.nextSteps) {
      diagnosticResult.nextSteps = {
        primary: {
          text: 'Solicitar consulta personalizada',
          link: '/contacto'
        },
        secondary: {
          text: 'Ver todos los servicios',
          link: '/servicios'
        }
      };
    }
    if (!diagnosticResult.urgency) {
      diagnosticResult.urgency = 'medium';
    }
  }
} catch (e: any) {
  error = e.message || 'Error desconocido';
  console.error('‚ùå Error loading diagnostic:', e);
  console.error('‚ùå Error stack:', e.stack);
}
---

<Layout 
  title={error ? `Error | Diagn√≥stico` : `Resultado de tu Diagn√≥stico | Maestro Digital`}
  description={error ? "Error al cargar el diagn√≥stico" : "Descubre la soluci√≥n digital perfecta para tu negocio basada en tu diagn√≥stico estrat√©gico."}
  image="/images/background-hero.jpg"
>
  {error ? (
    <section class="diagnostic-result">
      <div class="result-container">
        <div class="result-header">
          <div class="result-icon-large">‚ö†Ô∏è</div>
          <h1 class="result-title">Error al cargar el diagn√≥stico</h1>
          <p class="result-subtitle">{error}</p>
        </div>
        <div class="cta-group">
          <a href="/#diagnostico-estrategico" class="btn-cta-primary">
            Realizar nuevo diagn√≥stico
          </a>
          <a href="/soluciones" class="btn-cta-secondary">
            Ver todas las soluciones
          </a>
        </div>
      </div>
    </section>
  ) : diagnosticResult ? (
    <section class="diagnostic-result">
      <div class="result-container">
        {(() => {
          // Siempre usar el mismo dise√±o: componente React (localStorage o datos del backend)
          if (diagnosticResult._loadFromLocalStorage) {
            return (
              <DiagnosticResultClient 
                client:only="react" 
                diagnosticId={diagnosticResult._id || id} 
              />
            );
          }
          
          const isConversational = diagnosticResult.type === 'conversational' ||
                                  diagnosticResult.summary !== undefined ||
                                  diagnosticResult.insights !== undefined;
          
          // Diagn√≥sticos conversacionales desde backend: misma UI que localStorage
          if (isConversational) {
            const resultForClient = { ...diagnosticResult, id: diagnosticResult.id || id };
            return (
              <DiagnosticResultClient 
                client:only="react" 
                diagnosticId={id} 
                initialData={resultForClient}
              />
            );
          }
          
          const isEnhanced = diagnosticResult.opportunity !== undefined && 
                           diagnosticResult.recommendation !== undefined;
          
          if (isEnhanced) {
            return (
              <>
                {/* Vista mejorada con envelope completo (legacy) */}
                <div class="result-header">
                  <div class="result-icon-large">üí°</div>
                  <h1 class="result-title">{diagnosticResult.personalizedMessage?.title}</h1>
                  <p class="result-subtitle">{diagnosticResult.personalizedMessage?.subtitle}</p>
                </div>

                <div class="result-insight">
                  <p>{diagnosticResult.personalizedMessage?.insight}</p>
                </div>

                <div class="opportunity-section">
                  <div class="opportunity-header">
                    <h2 class="opportunity-title">{diagnosticResult.opportunity?.title}</h2>
                    <p class="opportunity-description">{diagnosticResult.opportunity?.description}</p>
                  </div>

                  <div class="opportunity-details">
                    <div class="pain-points">
                      <h3 class="section-title">Problemas Identificados</h3>
                      <ul class="points-list">
                        {(diagnosticResult.opportunity?.painPoints || []).map((point: string) => (
                          <li>{point}</li>
                        ))}
                      </ul>
                    </div>

                    <div class="benefits">
                      <h3 class="section-title">Beneficios de la Soluci√≥n</h3>
                      <ul class="points-list">
                        {(diagnosticResult.opportunity?.benefits || []).map((benefit: string) => (
                          <li>{benefit}</li>
                        ))}
                      </ul>
                    </div>
                  </div>
                </div>
              </>
            );
          } else {
            // Vista legacy
            return (
              <>
                <div class="result-header">
                  <div class="result-icon-large">{diagnosticResult.qualifies ? '‚úÖ' : 'üí°'}</div>
                  <h1 class="result-title">{diagnosticResult.personalizedMessage.title}</h1>
                  <p class="result-subtitle">{diagnosticResult.personalizedMessage.subtitle}</p>
                </div>
                <div class="result-insight">
                  <p>{diagnosticResult.personalizedMessage.insight}</p>
                </div>
              </>
            );
          }
        })()}

        {/* Soluci√≥n Principal */}
        {(() => {
          const primarySolution = diagnosticResult.recommendation?.primarySolution || diagnosticResult.primarySolution;
          const nextSteps = diagnosticResult.nextSteps;
          
          if (!primarySolution || !nextSteps) {
            return null;
          }
          
          return (
            <div class="primary-solution">
              <div class="solution-badge">Soluci√≥n Recomendada</div>
              <div class="solution-card-primary">
                <div class="solution-icon-large">
                  {primarySolution.icon || 'üí°'}
                </div>
                <h2 class="solution-title">
                  {primarySolution.title || 'Soluci√≥n Recomendada'}
                </h2>
                <p class="solution-description">
                  {primarySolution.description || 'Una soluci√≥n dise√±ada espec√≠ficamente para tu negocio'}
                </p>
                {primarySolution.reason && (
                  <div class="solution-reason">
                    <span class="reason-icon">üí°</span>
                    <span>{primarySolution.reason}</span>
                  </div>
                )}
                {primarySolution.matchScore !== undefined && (
                  <div class="solution-match">
                    <div class="match-bar">
                      <div class="match-fill" style={`width: ${primarySolution.matchScore}%`}></div>
                    </div>
                    <span class="match-text">Coincidencia: {primarySolution.matchScore}%</span>
                  </div>
                )}
                {nextSteps.primary && (
                  <a href={nextSteps.primary.link} class="btn-primary-large">
                    {nextSteps.primary.text} ‚Üí
                  </a>
                )}
              </div>
            </div>
          );
        })()}

        {/* M√≥dulos Recomendados (solo para envelope mejorado) */}
        {(() => {
          const recommendedModules = diagnosticResult.resultProfile?.recommendedModules;
          return recommendedModules && recommendedModules.length > 0 && (
            <div class="modules-section">
              <h3 class="modules-title">M√≥dulos Recomendados</h3>
              <p class="modules-subtitle">Estos m√≥dulos est√°n incluidos en la soluci√≥n recomendada</p>
              <div class="modules-grid">
                {recommendedModules.map((module: string) => (
                  <div class="module-card">
                    <span class="module-name">{module.replace(/-/g, ' ')}</span>
                  </div>
                ))}
              </div>
            </div>
          );
        })()}

        {/* Soluciones Complementarias */}
        {(() => {
          const complementarySolutions = diagnosticResult.recommendation?.complementarySolutions || diagnosticResult.complementarySolutions || [];
          return complementarySolutions.length > 0 && (
            <div class="complementary-solutions">
              <h3 class="complementary-title">Tambi√©n te puede interesar</h3>
              <p class="complementary-subtitle">Estas soluciones pueden complementar tu estrategia digital</p>
              <div class="solutions-grid">
                {complementarySolutions.map((solution: any) => (
                  <a href={`${solution.link}?from=diagnostico`} class="solution-card-complementary">
                    <div class="solution-icon">{solution.icon}</div>
                    <h4 class="solution-card-title">{solution.title}</h4>
                    <p class="solution-card-description">{solution.description}</p>
                    <div class="solution-card-reason">
                      <span class="reason-icon-small">üí°</span>
                      <span>{solution.reason}</span>
                    </div>
                    <span class="solution-link">Ver soluci√≥n ‚Üí</span>
                  </a>
                ))}
              </div>
            </div>
          );
        })()}

        <!-- Urgencia y CTA Final -->
        {diagnosticResult.nextSteps && diagnosticResult.nextSteps.primary && (
          <div class="result-cta-section">
            {diagnosticResult.urgency && (
              <div class="urgency-indicator" data-urgency={diagnosticResult.urgency}>
                {diagnosticResult.urgency === 'high' && (
                  <>
                    <span class="urgency-icon">‚ö°</span>
                    <span class="urgency-text">Tu negocio necesita esta soluci√≥n ahora</span>
                  </>
                )}
                {diagnosticResult.urgency === 'medium' && (
                  <>
                    <span class="urgency-icon">üìà</span>
                    <span class="urgency-text">Esta soluci√≥n puede acelerar tu crecimiento</span>
                  </>
                )}
                {diagnosticResult.urgency === 'low' && (
                  <>
                    <span class="urgency-icon">‚ú®</span>
                    <span class="urgency-text">Esta soluci√≥n puede optimizar tu operaci√≥n</span>
                  </>
                )}
              </div>
            )}
            
            <div class="cta-group">
              <a href={diagnosticResult.nextSteps.primary.link || '/contacto'} class="btn-cta-primary">
                {diagnosticResult.nextSteps.primary.text || 'Solicitar consulta'}
              </a>
              {diagnosticResult.nextSteps.secondary && (
                <a href={diagnosticResult.nextSteps.secondary.link || '/servicios'} class="btn-cta-secondary">
                  {diagnosticResult.nextSteps.secondary.text || 'Ver servicios'}
                </a>
              )}
              {(() => {
                const contactParams = contactName || contactCompany 
                  ? `?name=${encodeURIComponent(contactName)}&company=${encodeURIComponent(contactCompany)}`
                  : '';
                return (
                  <a href={`/contacto${contactParams}`} class="btn-cta-tertiary">
                    {diagnosticResult.opportunity ? 'Solicitar validaci√≥n operativa' : 'Hablar con un especialista'}
                  </a>
                );
              })()}
            </div>
          </div>
        )}
        
        {/* CTA alternativo si no hay nextSteps */}
        {(!diagnosticResult.nextSteps || !diagnosticResult.nextSteps.primary) && (
          <div class="result-cta-section">
            <div class="cta-group">
              {(() => {
                const contactParams = contactName || contactCompany 
                  ? `?name=${encodeURIComponent(contactName)}&company=${encodeURIComponent(contactCompany)}`
                  : '';
                return (
                  <>
                    <a href={`/contacto${contactParams}`} class="btn-cta-primary">
                      Solicitar consulta personalizada
                    </a>
                    <a href="/servicios" class="btn-cta-secondary">
                      Ver todos los servicios
                    </a>
                  </>
                );
              })()}
            </div>
          </div>
        )}
      </div>
    </section>
  ) : (
    <section class="diagnostic-result">
      <div class="result-container">
        <div class="loading-state">
          <div class="loading-spinner"></div>
          <p>Cargando tu diagn√≥stico...</p>
        </div>
      </div>
    </section>
  )}
</Layout>

<style is:global>
  .diagnostic-result {
    min-height: 100vh;
    padding: 6rem 2rem 4rem;
    background: var(--color-elephant-white, #F6F5F2);
  }

  .result-container {
    max-width: 1000px;
    margin: 0 auto;
  }

  /* Loading State */
  .loading-state {
    text-align: center;
    padding: 4rem 2rem;
  }

  .loading-spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #E5E5E3;
    border-top-color: #2B2B2B;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 1.5rem;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Header */
  .result-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .result-icon-large {
    font-size: 4rem;
    margin-bottom: 1.5rem;
  }

  .result-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(2rem, 5vw, 3.5rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-bottom: 1rem;
    line-height: 1.2;
  }

  .result-subtitle {
    font-size: clamp(1.125rem, 2vw, 1.5rem);
    color: var(--color-grey-medium, #9A9A97);
    line-height: 1.6;
  }

  /* ========== NUEVA JERARQU√çA ‚Äî HERO DE IMPACTO + SECCIONES 2-6 ========== */
  .result-section-title {
    font-size: clamp(1.35rem, 3vw, 1.75rem);
    font-weight: 700;
    color: #0f172a;
    text-align: center;
    margin: 0 0 1rem 0;
  }
  .result-hero-impact {
    background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
    border-radius: 24px;
    padding: 2.5rem 1.5rem 3rem;
    margin-bottom: 2.5rem;
    position: relative;
    overflow: hidden;
    opacity: 0;
    transform: translateY(24px);
    transition: opacity 0.7s cubic-bezier(0.22, 1, 0.36, 1), transform 0.7s cubic-bezier(0.22, 1, 0.36, 1);
  }
  .result-hero-impact::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse 80% 50% at 50% -20%, rgba(16, 185, 129, 0.18), transparent);
    pointer-events: none;
  }
  .result-hero-impact.result-reveal-visible { opacity: 1; transform: translateY(0); }
  .result-hero-impact-inner { position: relative; z-index: 1; text-align: center; }
  .result-hero-impact-title {
    font-size: clamp(1.6rem, 4vw, 2.25rem);
    font-weight: 700;
    color: #fff;
    margin: 0 0 0.4rem 0;
  }
  .result-hero-impact-subtitle {
    font-size: clamp(1rem, 2vw, 1.2rem);
    color: rgba(255,255,255,0.9);
    margin: 0 0 1.75rem 0;
  }
  .result-hero-impact-cards {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin-bottom: 1.75rem;
  }
  @media (max-width: 700px) {
    .result-hero-impact-cards { grid-template-columns: 1fr; }
  }
  .result-hero-impact-card {
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 16px;
    padding: 1.25rem;
    text-align: center;
  }
  .result-hero-impact-number {
    display: block;
    font-size: clamp(1.75rem, 4vw, 2.5rem);
    font-weight: 800;
    color: #34d399;
    line-height: 1.2;
  }
  .result-hero-impact-card-label {
    font-size: 0.8rem;
    color: rgba(255,255,255,0.85);
  }
  .result-hero-impact-cta {
    display: inline-block;
    background: #34d399;
    color: #0f172a;
    padding: 0.9rem 1.75rem;
    border-radius: 12px;
    font-weight: 700;
    text-decoration: none;
    transition: transform 0.2s, box-shadow 0.2s;
  }
  .result-hero-impact-cta:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(52,211,153,0.4); }

  .result-hero-equivalents {
    margin: 1.25rem 0 1.5rem 0;
    padding: 1rem 1.5rem;
    background: rgba(255,255,255,0.08);
    border-radius: 12px;
    display: inline-block;
  }
  .result-hero-equivalents-intro {
    font-size: 0.9rem;
    color: rgba(255,255,255,0.9);
    margin: 0 0 0.5rem 0;
  }
  .result-hero-equivalents-list {
    list-style: none;
    padding: 0;
    margin: 0;
    font-size: 1rem;
    color: rgba(255,255,255,0.95);
  }
  .result-hero-equivalents-list li { margin: 0.25rem 0; }
  .result-hero-equivalents-list strong { font-size: 1.15rem; margin-right: 0.35rem; }

  .result-credibility {
    margin-bottom: 2.5rem;
    padding: 1.5rem;
    background: #f8fafc;
    border-radius: 16px;
    border: 1px solid #e2e8f0;
  }
  .result-credibility-text {
    font-size: 1rem;
    color: #475569;
    line-height: 1.6;
    margin: 0;
    max-width: 640px;
  }

  .result-means-section { margin-bottom: 2.5rem; }
  .result-means-cards-equivalent .result-means-value { font-size: clamp(1rem, 2vw, 1.2rem); font-weight: 700; }
  .result-means-intro {
    text-align: center;
    color: #475569;
    margin: 0 0 1rem 0;
    font-size: 1.05rem;
  }
  .result-means-cards {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
  }
  @media (max-width: 600px) { .result-means-cards { grid-template-columns: 1fr; } }
  .result-means-card {
    background: #fff;
    border-radius: 16px;
    padding: 1.5rem;
    box-shadow: 0 4px 16px rgba(0,0,0,0.06);
    text-align: center;
  }
  .result-means-value { display: block; font-size: clamp(1.5rem, 3vw, 2rem); font-weight: 800; color: #0c4a6e; }
  .result-means-label { font-size: 0.9rem; color: #64748b; }

  .result-causes-section { margin-bottom: 2.5rem; }
  .result-causes-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    gap: 1rem;
  }
  .result-cause-card {
    background: #fff;
    border-radius: 16px;
    padding: 1.25rem;
    box-shadow: 0 4px 16px rgba(0,0,0,0.06);
    border-left: 4px solid #0ea5e9;
  }
  .result-cause-title { font-size: 1.05rem; font-weight: 700; color: #0f172a; margin: 0 0 0.5rem 0; }
  .result-cause-hours { font-size: 0.9rem; color: #64748b; margin: 0; }

  .result-before-after { margin-bottom: 2.5rem; }
  .result-before-after-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
  }
  @media (max-width: 600px) { .result-before-after-grid { grid-template-columns: 1fr; } }
  .result-ba-block {
    border-radius: 16px;
    padding: 1.5rem;
    text-align: center;
  }
  .result-ba-before { background: linear-gradient(135deg, #dc2626, #b91c1c); color: #fff; }
  .result-ba-after { background: linear-gradient(135deg, #059669, #047857); color: #fff; }
  .result-ba-result { background: linear-gradient(135deg, #0f172a, #1e293b); color: #fff; }
  .result-ba-label { display: block; font-size: 0.8rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.35rem; opacity: 0.95; }
  .result-ba-value { display: block; font-size: clamp(1.25rem, 2.5vw, 1.75rem); font-weight: 800; }
  .result-ba-sublabel { font-size: 0.85rem; opacity: 0.9; }

  .result-emotional {
    text-align: center;
    margin-bottom: 2.5rem;
    padding: 1.5rem;
  }
  .result-emotional-text {
    font-size: clamp(1.1rem, 2vw, 1.25rem);
    font-weight: 600;
    color: #0f172a;
    margin: 0;
    max-width: 560px;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.5;
  }
  .result-services-section { margin: 3rem 0 2rem; }
  .result-services-intro {
    text-align: center;
    color: #64748b;
    margin: 0 0 1.5rem 0;
    font-size: 1rem;
  }
  .result-services-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    max-width: 1200px;
    margin: 0 auto;
  }
  @media (max-width: 600px) {
    .result-services-grid { grid-template-columns: 1fr; gap: 1.25rem; }
  }

  /* ========== LEGACY HERO (mantener por si se usa en otra ruta) ========== */
  .result-hero-premium {
    background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
    border-radius: 24px;
    padding: 3rem 2rem 3.5rem;
    margin-bottom: 3rem;
    position: relative;
    overflow: hidden;
    opacity: 0;
    transform: translateY(24px);
    transition: opacity 0.7s cubic-bezier(0.22, 1, 0.36, 1), transform 0.7s cubic-bezier(0.22, 1, 0.36, 1);
  }
  .result-hero-premium::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(ellipse 80% 50% at 50% -20%, rgba(16, 185, 129, 0.2), transparent),
                radial-gradient(ellipse 60% 40% at 100% 50%, rgba(59, 130, 246, 0.12), transparent);
    pointer-events: none;
  }
  .result-hero-premium.result-reveal-visible {
    opacity: 1;
    transform: translateY(0);
  }
  .result-hero-premium-inner {
    position: relative;
    z-index: 1;
    text-align: center;
    max-width: 900px;
    margin: 0 auto;
  }
  .result-hero-premium-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.75rem, 4vw, 2.5rem);
    font-weight: 700;
    color: #fff;
    margin: 0 0 0.5rem 0;
    line-height: 1.25;
  }
  .result-hero-premium-subtitle {
    font-size: clamp(1rem, 1.5vw, 1.2rem);
    color: rgba(255, 255, 255, 0.85);
    margin: 0 0 2.5rem 0;
    line-height: 1.5;
  }
  .result-hero-premium-metrics {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
    align-items: center;
    justify-items: center;
  }
  @media (max-width: 700px) {
    .result-hero-premium-metrics {
      grid-template-columns: 1fr;
      gap: 1.25rem;
    }
  }
  .result-hero-metric-block {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .result-hero-metric-ring {
    --progress: 70;
    width: 120px;
    height: 120px;
    border-radius: 50%;
    background: conic-gradient(#34d399 calc(var(--progress) * 1%), rgba(255, 255, 255, 0.1) 0);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    margin-bottom: 0.5rem;
  }
  .result-hero-metric-ring::before {
    content: '';
    position: absolute;
    inset: 8px;
    border-radius: 50%;
    background: #1e293b;
  }
  .result-hero-metric-value,
  .result-hero-metric-label {
    position: relative;
    z-index: 1;
  }
  .result-hero-metric-value {
    font-size: clamp(1.5rem, 2.5vw, 2rem);
    font-weight: 800;
    color: #34d399;
    line-height: 1.2;
  }
  .result-hero-metric-label {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.75);
    text-align: center;
  }
  .result-hero-metric-ring-money .result-hero-metric-value { color: #6ee7b7; }
  .result-hero-metric-ring-roi {
    background: conic-gradient(#60a5fa calc(var(--progress) * 1%), rgba(255, 255, 255, 0.1) 0);
  }
  .result-hero-metric-ring-roi .result-hero-metric-value { color: #93c5fd; }

  /* ========== SECCI√ìN 3 ‚Äî Comparaci√≥n visual ========== */
  .result-comparison-section {
    margin-bottom: 3rem;
  }
  .result-comparison-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.5rem, 2.5vw, 2rem);
    color: #0c4a6e;
    text-align: center;
    margin: 0 0 0.5rem 0;
  }
  .result-comparison-subtitle {
    font-size: 1rem;
    color: #64748b;
    text-align: center;
    margin: 0 0 1.5rem 0;
  }
  .result-comparison-cards {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    max-width: 900px;
    margin: 0 auto;
  }
  @media (max-width: 700px) {
    .result-comparison-cards { grid-template-columns: 1fr; }
  }
  .result-comparison-card {
    border-radius: 20px;
    padding: 2rem;
    color: #fff;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    position: relative;
    overflow: hidden;
  }
  .result-comparison-card::before {
    content: '';
    position: absolute;
    top: -50%;
    right: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 60%);
    pointer-events: none;
  }
  .result-comparison-card-actual {
    background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
  }
  .result-comparison-card-optimized {
    background: linear-gradient(135deg, #059669 0%, #047857 100%);
  }
  .result-comparison-card-label {
    font-size: 0.875rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    opacity: 0.95;
    margin-bottom: 1.25rem;
    position: relative;
    z-index: 1;
  }
  .result-comparison-metric {
    position: relative;
    z-index: 1;
    margin-bottom: 0.75rem;
  }
  .result-comparison-value {
    font-size: clamp(1.75rem, 3vw, 2.25rem);
    font-weight: 800;
    display: block;
    line-height: 1.2;
  }
  .result-comparison-metric-label {
    font-size: 0.9375rem;
    opacity: 0.9;
  }
  .result-comparison-card-desc {
    font-size: 0.875rem;
    opacity: 0.85;
    margin: 1rem 0 0 0;
    padding-top: 1rem;
    border-top: 1px solid rgba(255, 255, 255, 0.2);
    position: relative;
    z-index: 1;
  }

  /* Grid Beneficios clave (hasta 6 cards, hover lift) */
  .result-beneficios-grid {
    margin-bottom: 3rem;
  }
  .result-beneficios-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.5rem, 2.5vw, 2rem);
    color: #0c4a6e;
    text-align: center;
    margin-bottom: 1.5rem;
  }
  .result-beneficios-cards {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.25rem;
  }
  @media (max-width: 900px) {
    .result-beneficios-cards { grid-template-columns: repeat(2, 1fr); }
  }
  @media (max-width: 600px) {
    .result-beneficios-cards { grid-template-columns: 1fr; }
  }
  .result-beneficio-card {
    background: #fff;
    border-radius: 16px;
    padding: 1.5rem;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
    border: 1px solid rgba(0, 0, 0, 0.04);
    transition: transform 0.25s ease, box-shadow 0.25s ease;
  }
  .result-beneficio-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.1);
  }
  .result-beneficio-icon {
    font-size: 2rem;
    margin-bottom: 0.75rem;
  }
  .result-beneficio-card-title {
    font-size: 1.1rem;
    font-weight: 700;
    color: #0c4a6e;
    margin: 0 0 0.5rem 0;
  }
  .result-beneficio-card-desc {
    font-size: 0.9rem;
    color: #475569;
    line-height: 1.5;
    margin: 0 0 0.75rem 0;
  }
  .result-beneficio-metric {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: #0369a1;
  }
  .result-beneficio-metric-icon { font-size: 1rem; }

  /* Testimonial + CTA verde */
  .result-testimonial-cta {
    margin-bottom: 3rem;
    text-align: center;
  }
  .result-testimonial {
    background: #f8fafc;
    border-radius: 20px;
    padding: 2rem 2rem 2.5rem;
    margin-bottom: 1.5rem;
    position: relative;
  }
  .result-testimonial-quote {
    font-size: 4rem;
    line-height: 1;
    color: #0ea5e9;
    opacity: 0.4;
    position: absolute;
    top: 0.5rem;
    left: 1.5rem;
    font-family: Georgia, serif;
  }
  .result-testimonial-text {
    font-size: 1.1rem;
    color: #334155;
    line-height: 1.65;
    margin: 0 0 1rem 0;
    padding-left: 0.5rem;
  }
  .result-testimonial-author {
    font-weight: 600;
    color: #0c4a6e;
    margin: 0 0 0.5rem 0;
  }
  .result-testimonial-stars {
    color: #f59e0b;
    font-size: 1.25rem;
    letter-spacing: 0.15em;
    margin-bottom: 1rem;
  }
  .result-testimonial-photo-wrap {
    display: flex;
    justify-content: center;
  }
  .result-testimonial-photo {
    width: 72px;
    height: 72px;
    border-radius: 50%;
    background: linear-gradient(135deg, #94a3b8, #64748b);
  }
  .result-cta-green {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: linear-gradient(135deg, #22c55e, #16a34a);
    color: #fff;
    padding: 1rem 1.75rem;
    border-radius: 12px;
    font-weight: 700;
    text-decoration: none;
    box-shadow: 0 4px 14px rgba(34, 197, 94, 0.4);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .result-cta-green:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(34, 197, 94, 0.5);
  }
  .result-cta-green-icon { font-size: 1.2rem; }

  /* Desglose de ahorro */
  .result-savings-breakdown { margin-bottom: 3rem; }
  .result-savings-breakdown-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 1rem;
  }
  .result-savings-breakdown-item { display: flex; flex-direction: column; align-items: flex-start; }
  .result-savings-breakdown-item .result-beneficio-metric { margin-bottom: 0.5rem; }

  /* Proyecci√≥n financiera */
  .result-projection-section { margin-bottom: 3rem; }
  .result-projection-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 1rem;
    max-width: 600px;
    margin: 0 auto;
  }
  .result-projection-card {
    background: #fff;
    border-radius: 16px;
    padding: 1.25rem;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
    text-align: center;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .result-projection-card:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08); }
  .result-projection-value { display: block; font-size: 1.5rem; font-weight: 800; color: #0c4a6e; }
  .result-projection-label { font-size: 0.875rem; color: #64748b; }

  /* Equivalencias */
  .result-equivalents-section { margin-bottom: 3rem; }
  .result-equivalents-list {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    justify-content: center;
  }
  .result-equivalent-item {
    background: #f0f9ff;
    border: 1px solid #bae6fd;
    border-radius: 12px;
    padding: 1rem 1.5rem;
    text-align: center;
  }
  .result-equivalent-value { display: block; font-size: 1.35rem; font-weight: 700; color: #0369a1; }
  .result-equivalent-label { font-size: 0.875rem; color: #0c4a6e; }

  /* Plan de oportunidades (pasos) */
  .result-opportunity-plan { margin-bottom: 3rem; }
  .result-opportunity-plan-steps {
    list-style: none;
    padding: 0;
    margin: 0;
    max-width: 640px;
    margin-left: auto;
    margin-right: auto;
  }
  .result-opportunity-plan-step {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
    padding: 1rem 0;
    border-bottom: 1px solid #e2e8f0;
  }
  .result-opportunity-plan-step:last-child { border-bottom: none; }
  .result-opportunity-plan-step-num {
    flex-shrink: 0;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: linear-gradient(135deg, #0ea5e9, #0369a1);
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 0.9375rem;
  }
  @media (max-width: 600px) {
    .result-savings-breakdown-list { grid-template-columns: 1fr; }
    .result-projection-cards { grid-template-columns: 1fr; }
    .result-equivalents-list { flex-direction: column; }
  }

  /* Reveal al scroll */
  .result-reveal {
    opacity: 0;
    transform: translateY(28px);
    transition: opacity 0.6s cubic-bezier(0.22, 1, 0.36, 1), transform 0.6s cubic-bezier(0.22, 1, 0.36, 1);
  }
  .result-reveal.result-reveal-visible {
    opacity: 1;
    transform: translateY(0);
  }
  .result-reveal-visible .current-situation-image {
    animation: resultImageReveal 0.8s cubic-bezier(0.22, 1, 0.36, 1) both;
  }
  .result-reveal-visible .opportunity-image-modern {
    animation: resultImageReveal 0.8s cubic-bezier(0.22, 1, 0.36, 1) both;
  }
  .result-reveal-visible .consequence-image-modern {
    animation: resultImageReveal 0.7s cubic-bezier(0.22, 1, 0.36, 1) both;
  }
  @keyframes resultImageReveal {
    from { opacity: 0; transform: scale(0.96); }
    to { opacity: 1; transform: scale(1); }
  }

  /* Insight */
  .result-insight {
    background: #FFFFFF;
    border-left: 4px solid #2B2B2B;
    padding: 1.5rem 2rem;
    margin-bottom: 3rem;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  }

  .result-insight p {
    font-size: 1.125rem;
    line-height: 1.8;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
  }

  /* Opportunity Section */
  .opportunity-section {
    background: #FFFFFF;
    border-radius: 16px;
    padding: 3rem;
    margin-bottom: 3rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }

  /* ============================================
     SECCI√ìN: LA OPORTUNIDAD - DISE√ëO MODERNO
     ============================================ */
  .opportunity-section-modern {
    margin-bottom: 4rem;
    border-radius: 24px;
    overflow: hidden;
    box-shadow: 
      0 10px 40px rgba(0, 0, 0, 0.08),
      0 2px 8px rgba(0, 0, 0, 0.04);
    position: relative;
    height: calc(100vh - 200px);
    max-height: 800px;
    min-height: 500px;
  }

  .opportunity-image-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  .opportunity-background-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    display: block;
  }

  .opportunity-content-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 3rem;
    z-index: 2;
  }

  .opportunity-title-box {
    background: #FFFFFF;
    border-radius: 12px;
    padding: 1.25rem 2rem;
    box-shadow: 
      0 8px 24px rgba(0, 0, 0, 0.15),
      0 2px 8px rgba(0, 0, 0, 0.1);
    margin-bottom: 1.5rem;
    text-align: center;
    max-width: 350px;
    width: auto;
  }

  .opportunity-title-overlay {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.5rem, 3vw, 2rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
    line-height: 1.2;
  }

  .opportunity-text-box {
    background: #FFFFFF;
    border-radius: 16px;
    padding: 2rem 2.5rem;
    box-shadow: 
      0 12px 32px rgba(0, 0, 0, 0.2),
      0 4px 12px rgba(0, 0, 0, 0.15);
    max-width: 900px;
    width: 100%;
    text-align: left;
  }

  .opportunity-text-overlay {
    font-size: clamp(1rem, 1.5vw, 1.25rem);
    line-height: 1.8;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
  }

  .opportunity-header {
    text-align: center;
    margin-bottom: 2.5rem;
  }

  .opportunity-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.75rem, 4vw, 2.5rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-bottom: 1rem;
  }

  .opportunity-description {
    font-size: 1.125rem;
    color: var(--color-grey-medium, #9A9A97);
    line-height: 1.6;
  }

  .opportunity-details {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin-top: 2rem;
  }

  .pain-points, .benefits {
    background: #F6F5F2;
    padding: 2rem;
    border-radius: 12px;
  }

  /* Estilos para secciones conversacionales - deben tener mayor especificidad */
  .cost-summary-section .section-title,
  .insights-section .section-title,
  .opportunity-section .section-title,
  .vision-section .section-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.5rem, 3vw, 2rem) !important;
    font-weight: 700 !important;
    color: var(--color-graphite-dark, #2B2B2B) !important;
    margin-bottom: 1.5rem !important;
    text-align: center !important;
  }

  .section-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-bottom: 1.5rem;
  }

  .points-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .points-list li {
    padding: 0.75rem 0;
    padding-left: 1.5rem;
    position: relative;
    font-size: 1rem;
    line-height: 1.6;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .pain-points .points-list li::before {
    content: '‚ö†Ô∏è';
    position: absolute;
    left: 0;
  }

  .benefits .points-list li::before {
    content: '‚úÖ';
    position: absolute;
    left: 0;
  }

  /* Modules Section */
  .modules-section {
    background: #FFFFFF;
    border-radius: 16px;
    padding: 3rem;
    margin-bottom: 3rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }

  .modules-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.5rem, 3vw, 2rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    text-align: center;
    margin-bottom: 0.5rem;
  }

  .modules-subtitle {
    text-align: center;
    color: var(--color-grey-medium, #9A9A97);
    margin-bottom: 2rem;
  }

  .modules-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 1rem;
  }

  .module-card {
    background: #F6F5F2;
    padding: 1rem;
    border-radius: 8px;
    text-align: center;
  }

  .module-name {
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--color-graphite-dark, #2B2B2B);
    text-transform: capitalize;
  }

  /* Primary Solution */
  .primary-solution {
    margin-bottom: 4rem;
  }

  .solution-badge {
    display: inline-block;
    background: #2B2B2B;
    color: #FFFFFF;
    padding: 0.5rem 1.5rem;
    border-radius: 999px;
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 1.5rem;
  }

  .solution-card-primary {
    background: #FFFFFF;
    border-radius: 16px;
    padding: 3rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    text-align: center;
  }

  .solution-icon-large {
    font-size: 4rem;
    margin-bottom: 1.5rem;
  }

  .solution-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.75rem, 4vw, 2.5rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-bottom: 1rem;
  }

  .solution-description {
    font-size: 1.125rem;
    line-height: 1.8;
    color: var(--color-grey-medium, #9A9A97);
    margin-bottom: 1.5rem;
  }

  .solution-reason {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    background: #F6F5F2;
    padding: 1rem 1.5rem;
    border-radius: 8px;
    margin-bottom: 1.5rem;
    font-size: 1rem;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .reason-icon {
    font-size: 1.25rem;
  }

  .solution-match {
    margin-bottom: 2rem;
  }

  .match-bar {
    width: 100%;
    height: 8px;
    background: #E5E5E3;
    border-radius: 999px;
    overflow: hidden;
    margin-bottom: 0.5rem;
  }

  .match-fill {
    height: 100%;
    background: linear-gradient(90deg, #2B2B2B 0%, #4A4A4A 100%);
    transition: width 0.3s ease;
  }

  .match-text {
    font-size: 0.875rem;
    color: var(--color-grey-medium, #9A9A97);
  }

  .btn-primary-large {
    display: inline-block;
    background: #2B2B2B;
    color: #FFFFFF;
    padding: 1rem 2.5rem;
    border-radius: 8px;
    font-size: 1.125rem;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .btn-primary-large:hover {
    background: #1A1A1A;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(43, 43, 43, 0.3);
  }

  /* Complementary Solutions */
  .complementary-solutions {
    margin-bottom: 4rem;
  }

  .complementary-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.5rem, 3vw, 2rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    text-align: center;
    margin-bottom: 0.5rem;
  }

  .complementary-subtitle {
    text-align: center;
    color: var(--color-grey-medium, #9A9A97);
    margin-bottom: 2rem;
  }

  .solutions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
  }

  .solution-card-complementary {
    background: #FFFFFF;
    border-radius: 12px;
    padding: 2rem;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
    text-decoration: none;
    transition: all 0.3s ease;
    display: block;
  }

  .solution-card-complementary:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }

  .solution-icon {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }

  .solution-card-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-bottom: 0.75rem;
  }

  .solution-card-description {
    font-size: 0.95rem;
    color: var(--color-grey-medium, #9A9A97);
    line-height: 1.6;
    margin-bottom: 1rem;
  }

  .solution-card-reason {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-bottom: 1rem;
  }

  .reason-icon-small {
    font-size: 1rem;
  }

  .solution-link {
    display: inline-block;
    color: #2B2B2B;
    font-weight: 600;
    font-size: 0.95rem;
  }

  /* Urgency and CTA */
  .result-cta-section {
    text-align: center;
    padding-top: 3rem;
    border-top: 1px solid #E5E5E3;
  }

  .urgency-indicator {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 2rem;
    border-radius: 8px;
    margin-bottom: 2rem;
    font-weight: 600;
  }

  .urgency-indicator[data-urgency="high"] {
    background: #FEE2E2;
    color: #991B1B;
  }

  .urgency-indicator[data-urgency="medium"] {
    background: #FEF3C7;
    color: #92400E;
  }

  .urgency-indicator[data-urgency="low"] {
    background: #DBEAFE;
    color: #1E40AF;
  }

  .urgency-icon {
    font-size: 1.5rem;
  }

  .urgency-text {
    font-size: 1.125rem;
  }

  .cta-group {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    justify-content: center;
    align-items: center;
  }

  .btn-cta-primary {
    display: inline-block;
    background: #2B2B2B;
    color: #FFFFFF;
    padding: 1rem 2rem;
    border-radius: 8px;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .btn-cta-primary:hover {
    background: #1A1A1A;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(43, 43, 43, 0.3);
  }

  .btn-cta-secondary {
    display: inline-block;
    background: transparent;
    color: #2B2B2B;
    border: 2px solid #2B2B2B;
    padding: 1rem 2rem;
    border-radius: 8px;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .btn-cta-secondary:hover {
    background: #2B2B2B;
    color: #FFFFFF;
  }

  .btn-cta-tertiary {
    display: inline-block;
    color: var(--color-grey-medium, #9A9A97);
    padding: 1rem 2rem;
    font-weight: 600;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .btn-cta-tertiary:hover {
    color: #2B2B2B;
  }

  /* ============================================
     ESTILOS PARA VISTA CONSULTIVA CONVERSACIONAL
     ============================================ */
  
  /* ============================================
     SECCI√ìN: RESUMEN DE TU SITUACI√ìN ACTUAL - DISE√ëO MODERNO
     ============================================ */
  .cost-summary-section-modern {
    margin-bottom: 4rem;
    position: relative;
  }

  .cost-summary-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(2rem, 4vw, 2.5rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0 auto -1.5rem auto;
    padding: 1.5rem 2rem;
    background: #FFFFFF;
    border-radius: 16px 16px 0 0;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    position: relative;
    z-index: 2;
    display: block;
    text-align: center;
    transform: translateY(-1rem);
    max-width: fit-content;
  }

  .cost-summary-content {
    background: #FFFFFF;
    border-radius: 24px;
    padding: 3rem 2rem 2rem 2rem;
    box-shadow: 
      0 10px 40px rgba(0, 0, 0, 0.08),
      0 2px 8px rgba(0, 0, 0, 0.04);
    position: relative;
    overflow: visible;
  }

  .cost-summary-image-container {
    position: relative;
    width: 100%;
    margin: 0;
  }

  .cost-summary-image-wrapper {
    width: 100%;
    height: 650px;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    background: #F8F9FA;
    position: relative;
  }

  .cost-summary-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    display: block;
  }

  .cost-comparison-overlay {
    position: absolute;
    bottom: 4rem;
    left: 0;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 2rem;
    padding: 0 2rem;
    z-index: 3;
  }

  .cost-card-modern {
    flex: 0 1 auto;
    min-width: 280px;
    max-width: 320px;
    background: #FFFFFF;
    border-radius: 16px;
    padding: 2.5rem 2rem;
    box-shadow: 
      0 12px 32px rgba(0, 0, 0, 0.2),
      0 4px 12px rgba(0, 0, 0, 0.15);
    border: 3px solid;
    transition: all 0.3s ease;
    position: relative;
  }

  .cost-card-modern:hover {
    transform: translateY(-4px);
    box-shadow: 
      0 12px 32px rgba(0, 0, 0, 0.15),
      0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .cost-card-current {
    border-color: #DC2626;
  }

  .cost-card-potential {
    border-color: #10B981;
  }

  .cost-card-label {
    font-size: 0.875rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 1.5rem;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .cost-card-values {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
  }

  .cost-card-value-time,
  .cost-card-value-money {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    line-height: 1.2;
  }

  .cost-card-value-time.savings,
  .cost-card-value-money.savings {
    color: #10B981;
  }

  .cost-card-description {
    font-size: 0.875rem;
    line-height: 1.6;
    color: var(--color-grey-medium, #6B7280);
    margin-top: 1rem;
  }

  .cost-arrow-modern {
    font-size: 3rem;
    color: var(--color-grey-medium, #9A9A97);
    font-weight: 300;
    flex-shrink: 0;
    margin: 0 1rem;
  }

  .roi-indicator-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    text-align: center;
    padding: 1.25rem 2rem;
    background: linear-gradient(135deg, #F0FDF4 0%, #D1FAE5 100%);
    border-radius: 0 0 16px 16px;
    box-shadow: 0 -4px 12px rgba(16, 185, 129, 0.2);
    z-index: 4;
  }

  .roi-indicator-modern {
    text-align: center;
    margin-top: 2.5rem;
    padding: 1.25rem 2rem;
    background: linear-gradient(135deg, #F0FDF4 0%, #D1FAE5 100%);
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.2);
  }

  .roi-label-modern {
    font-size: 1rem;
    font-weight: 600;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-right: 0.75rem;
  }

  .roi-value-modern {
    font-size: 1.75rem;
    font-weight: 700;
    color: #10B981;
  }

  /* Responsive */
  @media (max-width: 968px) {
    .cost-summary-title {
      transform: translateY(0);
      margin-bottom: 0;
      border-radius: 16px;
    }

    .cost-summary-content {
      border-radius: 16px;
      padding: 2rem 1.5rem;
    }

    .cost-summary-image-wrapper {
      height: 500px;
    }

    .cost-comparison-overlay {
      position: relative;
      bottom: auto;
      flex-direction: column;
      gap: 1.5rem;
      padding: 2rem 0 0 0;
      margin-top: 2rem;
    }

    .cost-arrow-modern {
      transform: rotate(90deg);
      margin: 0;
    }

    .cost-card-modern {
      width: 100%;
      max-width: 100%;
    }

    .roi-indicator-overlay {
      position: relative;
      bottom: auto;
      border-radius: 12px;
      margin-top: 2rem;
    }
  }

  @media (max-width: 640px) {
    .cost-summary-title {
      font-size: 1.75rem;
      padding: 1.25rem 1.5rem;
    }

    .cost-summary-image-wrapper {
      height: 300px;
    }

    .cost-card-modern {
      padding: 2rem 1.5rem;
    }

    .cost-card-value-time,
    .cost-card-value-money {
      font-size: 1.5rem;
    }
  }

  /* Estilos legacy para compatibilidad */
  .cost-summary-section {
    margin-bottom: 3rem;
    background: #FFFFFF;
    border-radius: 16px;
    padding: 3rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    width: 100%;
    display: block;
  }

  .cost-comparison {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 2rem;
    margin: 2rem 0;
    flex-wrap: wrap;
  }

  .cost-card {
    background: #FFFFFF;
    border-radius: 12px;
    padding: 2rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    min-width: 250px;
    max-width: 300px;
    text-align: center;
    flex: 1;
    display: block;
    width: 100%;
  }

  .cost-card.current {
    border: 2px solid #DC2626;
  }

  .cost-card.potential {
    border: 2px solid #10B981;
  }

  .cost-label {
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 1rem;
    color: var(--color-grey-medium, #9A9A97);
  }

  .cost-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0.5rem 0;
  }

  .cost-value.savings {
    color: #10B981;
  }

  .cost-description {
    font-size: 0.875rem;
    color: var(--color-grey-medium, #9A9A97);
    margin-top: 1rem;
  }

  .arrow {
    font-size: 2rem;
    color: var(--color-grey-medium, #9A9A97);
  }

  .roi-indicator {
    text-align: center;
    margin-top: 2rem;
    padding: 1rem;
    background: #F0FDF4;
    border-radius: 8px;
  }

  .roi-label {
    font-size: 1rem;
    color: var(--color-grey-medium, #9A9A97);
    margin-right: 0.5rem;
  }

  .roi-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #10B981;
  }

  .opportunity-section,
  .vision-section {
    background: #FFFFFF !important;
    border-radius: 12px !important;
    padding: 2rem !important;
    margin-bottom: 3rem !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
    display: block !important;
  }

  /* ============================================
     SECCI√ìN: TU VISI√ìN - DISE√ëO MODERNO
     ============================================ */
  .vision-section-modern {
    margin-bottom: 4rem;
    border-radius: 24px;
    overflow: hidden;
    box-shadow: 
      0 10px 40px rgba(0, 0, 0, 0.08),
      0 2px 8px rgba(0, 0, 0, 0.04);
    position: relative;
    height: calc(100vh - 200px);
    max-height: 700px;
    min-height: 500px;
  }

  .vision-image-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  .vision-background-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    display: block;
  }

  .vision-content-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: center;
    padding: 4rem;
    z-index: 2;
  }

  @media (max-width: 1024px) {
    .vision-content-overlay {
      grid-template-columns: 1fr;
      gap: 2rem;
      padding: 3rem;
    }
  }

  .vision-title-overlay {
    display: flex;
    align-items: center;
    justify-content: flex-start;
  }

  .vision-title-text {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(2.5rem, 5vw, 4rem);
    font-weight: 700;
    color: #FFFFFF;
    margin: 0;
    line-height: 1.1;
    text-shadow: 
      0 2px 8px rgba(0, 0, 0, 0.5),
      0 4px 16px rgba(0, 0, 0, 0.3),
      0 0 20px rgba(0, 0, 0, 0.2);
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.4));
  }

  .vision-text-overlay {
    display: flex;
    align-items: center;
    justify-content: flex-start;
  }

  .vision-text-content {
    font-size: clamp(1rem, 1.5vw, 1.25rem);
    line-height: 1.8;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
    background: rgba(255, 255, 255, 0.95);
    padding: 2rem 2.5rem;
    border-radius: 16px;
    box-shadow: 
      0 8px 24px rgba(0, 0, 0, 0.15),
      0 2px 8px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
  }

  .opportunity-text,
  .vision-text {
    font-size: 1.125rem;
    line-height: 1.8;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-top: 1rem;
  }

  .insights-section {
    margin-bottom: 3rem;
    width: 100%;
    display: block;
  }

  /* ============================================
     SECCI√ìN: PROBLEMAS IDENTIFICADOS - DISE√ëO MODERNO
     ============================================ */
  .insights-section-modern {
    margin-bottom: 4rem;
    width: 100%;
  }

  .insights-header-image {
    position: relative;
    width: 100%;
    border-radius: 24px;
    overflow: hidden;
    margin-bottom: 3rem;
    box-shadow: 
      0 10px 40px rgba(0, 0, 0, 0.08),
      0 2px 8px rgba(0, 0, 0, 0.04);
    height: calc(100vh - 200px);
    max-height: 500px;
    min-height: 400px;
  }

  .insights-background-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    display: block;
  }

  .insights-title-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #FFFFFF;
    border-radius: 16px;
    padding: 1.5rem 3rem;
    box-shadow: 
      0 12px 32px rgba(0, 0, 0, 0.2),
      0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 2;
  }

  .insights-title-text {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.5rem, 3vw, 2rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
    text-align: center;
  }

  .insight-card-modern {
    margin-bottom: 3rem;
    width: 100%;
    background: #FFFFFF;
    border-radius: 24px;
    padding: 2.5rem;
    box-shadow: 
      0 10px 40px rgba(0, 0, 0, 0.08),
      0 2px 8px rgba(0, 0, 0, 0.04);
    border: 1px solid #E5E5E3;
  }

  .insight-problem-header {
    text-align: center;
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 2px solid #F6F5F2;
  }

  .insight-problem-title {
    font-size: clamp(1.25rem, 2vw, 1.5rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
    line-height: 1.3;
  }

  .insight-content-wrapper {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    margin-bottom: 1.5rem;
    align-items: stretch;
  }

  @media (max-width: 1024px) {
    .insight-content-wrapper {
      grid-template-columns: 1fr;
    }
  }

  .insight-right-column {
    display: flex;
    flex-direction: column;
    gap: 2rem;
    height: 100%;
  }

  .insight-main-card {
    background: #FFFFFF;
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 
      0 4px 12px rgba(0, 0, 0, 0.08),
      0 2px 4px rgba(0, 0, 0, 0.04);
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    flex: 1;
    height: 100%;
  }

  @media (max-width: 768px) {
    .insight-main-card {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }
  }

  .insight-costs-column {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    justify-content: space-between;
  }

  .cost-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .cost-label-modern {
    font-size: 0.95rem;
    color: var(--color-grey-medium, #6B7280);
    font-weight: 500;
  }

  .cost-value-modern {
    font-size: 1rem;
    font-weight: 600;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .insight-savings-column {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    justify-content: flex-start;
  }

  .savings-label-modern {
    font-size: 0.875rem;
    font-weight: 600;
    color: #10B981;
    margin-bottom: 0.5rem;
  }

  .savings-value-time,
  .savings-value-money {
    font-size: 1rem;
    font-weight: 600;
    color: #10B981;
  }

  .insight-recommendation-card {
    background: #E0F2FE;
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 
      0 4px 12px rgba(0, 0, 0, 0.08),
      0 2px 4px rgba(0, 0, 0, 0.04);
    flex: 1;
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .recommendation-title-modern {
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0 0 0.75rem 0;
  }

  .recommendation-description-modern {
    font-size: 0.95rem;
    line-height: 1.6;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0 0 1rem 0;
  }

  .benefits-list-modern {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .benefit-item-modern {
    font-size: 0.9rem;
    line-height: 1.6;
    color: var(--color-graphite-dark, #2B2B2B);
    padding-left: 0;
  }

  .insight-impact-card {
    background: #FEF3C7;
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 
      0 4px 12px rgba(0, 0, 0, 0.08),
      0 2px 4px rgba(0, 0, 0, 0.04);
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .impact-item-modern {
    font-size: 0.95rem;
    line-height: 1.8;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-bottom: 1rem;
  }

  .impact-item-modern:last-child {
    margin-bottom: 0;
  }

  .impact-item-modern strong {
    font-weight: 600;
    display: block;
    margin-bottom: 0.25rem;
  }

  .insight-card {
    background: #FFFFFF !important;
    border-radius: 12px !important;
    padding: 0 !important;
    margin-bottom: 2rem !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
    position: relative;
    overflow: hidden;
    border-left: 4px solid #2B2B2B !important;
  }
  
  .insight-image {
    width: 100%;
    max-width: 100%;
    height: auto;
    border-radius: 12px 12px 0 0;
    margin: 0;
    object-fit: cover;
    max-height: 300px;
    display: block;
  }
  
  .insight-card .insight-header {
    padding: 2rem 2rem 1rem 2rem;
  }
  
  .insight-card .insight-details,
  .insight-card .insight-impact,
  .insight-card .insight-recommendation {
    padding: 0 2rem 1.5rem 2rem;
  }

  .insight-problem {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-bottom: 1.5rem;
  }

  .insight-details {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 2rem !important;
    margin-bottom: 1.5rem !important;
    width: 100% !important;
  }

  .insight-costs,
  .insight-savings {
    padding: 1rem !important;
    background: #F6F5F2 !important;
    border-radius: 8px !important;
    display: block !important;
    width: 100% !important;
  }

  .cost-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 0.5rem;
    font-size: 0.95rem;
  }

  .cost-item .cost-label {
    color: var(--color-grey-medium, #9A9A97);
    font-weight: 500;
    text-transform: none;
    letter-spacing: normal;
    margin: 0;
  }

  .cost-item .cost-value {
    font-size: 1rem;
    font-weight: 600;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
  }

  .savings-label {
    font-size: 0.875rem;
    font-weight: 600;
    color: #10B981;
    margin-bottom: 0.5rem;
  }

  .savings-values {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .savings-values span {
    font-size: 1rem;
    font-weight: 600;
    color: #10B981;
  }

  .insight-impact {
    margin: 1.5rem 0 !important;
    padding: 1rem !important;
    background: #FEF3C7 !important;
    border-radius: 8px !important;
    display: block !important;
    width: 100% !important;
  }

  .impact-item {
    margin-bottom: 0.75rem;
    font-size: 0.95rem;
    line-height: 1.6;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .impact-item:last-child {
    margin-bottom: 0;
  }

  .insight-recommendation {
    margin-top: 1.5rem !important;
    padding-top: 1.5rem !important;
    border-top: 1px solid #E5E5E3 !important;
    display: block !important;
    width: 100% !important;
  }

  .insight-header {
    display: block !important;
    width: 100% !important;
    margin-bottom: 1.5rem !important;
  }

  .cost-comparison {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 2rem !important;
    margin: 2rem 0 !important;
    flex-wrap: wrap !important;
    width: 100% !important;
  }

  .arrow {
    display: inline-block !important;
    font-size: 2rem !important;
    color: var(--color-grey-medium, #9A9A97) !important;
  }

  /* Nuevas secciones con im√°genes */
  /* ============================================
     SECCI√ìN: TU SITUACI√ìN ACTUAL - DISE√ëO MODERNO
     ============================================ */
  .current-situation-section-modern {
    margin-bottom: 4rem;
    padding: 0;
  }

  .current-situation-content {
    display: grid;
    grid-template-columns: 1.2fr 1fr;
    gap: 4rem;
    align-items: stretch;
    background: linear-gradient(135deg, #FFFFFF 0%, #F8F9FA 100%);
    border-radius: 24px;
    padding: 4rem;
    box-shadow: 
      0 10px 40px rgba(0, 0, 0, 0.08),
      0 2px 8px rgba(0, 0, 0, 0.04);
    position: relative;
    overflow: hidden;
    min-height: 600px;
  }

  .current-situation-content::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #10B981 0%, #059669 100%);
    border-radius: 24px 24px 0 0;
  }

  .current-situation-text {
    display: flex;
    flex-direction: column;
    gap: 2rem;
    justify-content: center;
  }

  .current-situation-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(2rem, 4vw, 3rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
    line-height: 1.2;
    letter-spacing: -0.02em;
  }

  .current-situation-description {
    font-size: clamp(1rem, 1.5vw, 1.25rem);
    line-height: 1.8;
    color: var(--color-grey-medium, #6B7280);
    margin: 0;
  }

  .current-situation-highlights {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .current-situation-highlight-item {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1rem 1.5rem;
    background: #FFFFFF;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    transition: all 0.3s ease;
  }

  .current-situation-highlight-item:hover {
    transform: translateX(4px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }

  .highlight-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    min-width: 28px;
    background: linear-gradient(135deg, #10B981 0%, #059669 100%);
    color: #FFFFFF;
    border-radius: 50%;
    font-size: 1rem;
    font-weight: 600;
    flex-shrink: 0;
  }

  .highlight-text {
    font-size: 1rem;
    line-height: 1.6;
    color: var(--color-graphite-dark, #2B2B2B);
    font-weight: 500;
  }

  .current-situation-image-wrapper {
    position: relative;
    border-radius: 0 20px 20px 0;
    overflow: hidden;
    box-shadow: 
      0 20px 60px rgba(0, 0, 0, 0.15),
      0 8px 24px rgba(0, 0, 0, 0.1);
    background: #FFFFFF;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .current-situation-image {
    width: 100%;
    height: 100%;

    display: block;
    object-fit: cover;
    object-position: center;
    transition: transform 0.4s ease;
  }

  .current-situation-image-wrapper:hover .current-situation-image {
    transform: scale(1.02);
  }

  /* Responsive para m√≥vil */
  @media (max-width: 968px) {
    .current-situation-content {
      grid-template-columns: 1fr;
      gap: 3rem;
      padding: 3rem 2rem;
    }

    .current-situation-image-wrapper {
      order: -1;
    }

    .current-situation-title {
      font-size: 2rem;
    }

    .current-situation-description {
      font-size: 1rem;
    }
  }

  @media (max-width: 640px) {
    .current-situation-content {
      padding: 2rem 1.5rem;
      border-radius: 16px;
    }

    .current-situation-title {
      font-size: 1.75rem;
    }

    .current-situation-highlight-item {
      padding: 0.875rem 1.25rem;
    }

    .highlight-icon {
      width: 24px;
      height: 24px;
      min-width: 24px;
      font-size: 0.875rem;
    }

    .highlight-text {
      font-size: 0.9375rem;
    }
  }

  /* Estilos legacy para otras secciones */
  /* ============================================
     SECCI√ìN: OPORTUNIDADES DETECTADAS - DISE√ëO MODERNO CON SLIDER
     ============================================ */
  .opportunities-section-modern {
    margin-bottom: 4rem;
  }

  .opportunities-section-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(2rem, 4vw, 2.5rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0 0 3rem 0;
    text-align: center;
  }

  .opportunities-slider-wrapper {
    position: relative;
    background: #FFFFFF;
    border-radius: 24px;
    padding: 0;
    box-shadow: 
      0 10px 40px rgba(0, 0, 0, 0.08),
      0 2px 8px rgba(0, 0, 0, 0.04);
    overflow: hidden;
    width: 100%;
    max-width: 100%;
  }

  .opportunities-slider-wrapper > .opportunities-slider {
    overflow: hidden;
  }

  .opportunities-slider {
    display: flex;
    transition: transform 0.5s cubic-bezier(0.22, 0.61, 0.36, 1);
    width: 100%;
    overflow: visible;
    position: relative;
    will-change: transform;
  }

  .opportunity-slide {
    min-width: 100%;
    max-width: 100%;
    flex: 0 0 100%;
    flex-shrink: 0;
    display: block;
    width: 100%;
    opacity: 1;
    visibility: visible;
    box-sizing: border-box;
  }

  .opportunity-card-modern {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0;
    align-items: stretch;
    min-height: 600px;
    width: 100%;
    max-width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    border-radius: 20px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    transition: transform 0.25s ease, box-shadow 0.25s ease;
  }
  .opportunity-card-modern:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
  }

  .opportunity-image-wrapper {
    position: relative;
    overflow: hidden;
    background: #F8F9FA;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    min-height: 600px;
  }

  .opportunity-image-modern {
    width: 100%;
    height: 100%;
    min-height: 600px;
    object-fit: cover;
    object-position: center;
    display: block;
  }

  .opportunity-content-modern {
    padding: 4rem 3rem;
    display: flex;
    flex-direction: column;
    gap: 2rem;
    background: linear-gradient(135deg, #FFFFFF 0%, #F8F9FA 100%);
    width: 100%;
    height: 100%;
    min-height: 600px;
    box-sizing: border-box;
    overflow-y: auto;
  }

  .opportunity-title-modern {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.75rem, 3vw, 2.25rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
    line-height: 1.2;
  }

  .opportunity-description-modern {
    font-size: clamp(1rem, 1.5vw, 1.125rem);
    line-height: 1.8;
    color: var(--color-grey-medium, #6B7280);
    margin: 0;
  }

  .opportunity-impact-modern {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 1rem;
  }

  .impact-item-modern {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 1.5rem;
    background: #FFFFFF;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  }

  .impact-icon {
    font-size: 1.5rem;
    flex-shrink: 0;
  }

  .impact-text {
    font-size: 1rem;
    font-weight: 500;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .improvement-list-modern {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .improvement-item-modern {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    font-size: 1rem;
    line-height: 1.6;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .improvement-icon {
    color: #10B981;
    font-size: 1.25rem;
    font-weight: 700;
    flex-shrink: 0;
    margin-top: 0.125rem;
  }

  .opportunity-nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 3rem;
    height: 3rem;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid var(--color-grey-light);
    border-radius: 50%;
    color: var(--color-graphite-dark);
    font-size: 1.5rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
  }

  .opportunity-nav-btn:hover {
    background: var(--color-graphite-dark);
    color: #FFFFFF;
    border-color: var(--color-graphite-dark);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
  }

  .opportunity-nav-prev {
    left: 1.5rem;
  }

  .opportunity-nav-next {
    right: 1.5rem;
  }

  .opportunity-indicators {
    display: flex;
    justify-content: center;
    gap: 0.75rem;
    padding: 2rem;
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 10;
    background: linear-gradient(to top, rgba(255, 255, 255, 0.95) 0%, transparent 100%);
  }

  .opportunity-indicator {
    width: 0.75rem;
    height: 0.75rem;
    border-radius: 50%;
    background: var(--color-grey-light);
    border: 2px solid transparent;
    cursor: pointer;
    transition: all 0.3s ease;
    padding: 0;
  }

  .opportunity-indicator:hover,
  .opportunity-indicator.active {
    background: var(--color-graphite-dark);
    transform: scale(1.2);
    border-color: var(--color-graphite-dark);
  }

  /* Responsive */
  @media (max-width: 968px) {
    .opportunity-card-modern {
      grid-template-columns: 1fr;
      min-height: auto;
    }

    .opportunity-image-wrapper {
      height: 400px;
      order: -1;
    }

    .opportunity-content-modern {
      padding: 3rem 2rem;
    }

    .opportunity-nav-btn {
      width: 2.5rem;
      height: 2.5rem;
      font-size: 1.25rem;
    }

    .opportunity-nav-prev {
      left: 1rem;
    }

    .opportunity-nav-next {
      right: 1rem;
    }
  }

  @media (max-width: 640px) {
    .opportunity-image-wrapper {
      height: 300px;
    }

    .opportunity-content-modern {
      padding: 2rem 1.5rem;
    }

    .opportunity-title-modern {
      font-size: 1.5rem;
    }
  }

  /* ========== RESULTADO LEGIBLE Y BONITO (m√≥vil primero) ========== */
  .diagnostic-result-mobile .result-description {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .diagnostic-result-mobile .result-description.result-expanded {
    -webkit-line-clamp: unset;
    display: block;
  }
  .result-ver-mas {
    margin-top: 0.5rem;
    padding: 0.35rem 0.75rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: #059669;
    background: transparent;
    border: none;
    cursor: pointer;
    text-decoration: underline;
    appearance: none;
  }
  .result-ver-mas:hover {
    color: #047857;
  }
  @media (max-width: 768px) {
    .diagnostic-result-mobile .current-situation-content {
      padding: 1.5rem 1rem;
      gap: 1.5rem;
    }
    .diagnostic-result-mobile .current-situation-description {
      font-size: 0.9375rem;
      line-height: 1.5;
    }
    .diagnostic-result-mobile .highlight-chip .highlight-text {
      font-size: 0.875rem;
    }
    .diagnostic-result-mobile .current-situation-highlight-item {
      padding: 0.6rem 1rem;
    }
    .diagnostic-result-mobile .opportunity-content-modern {
      padding: 1.5rem 1rem;
      gap: 1rem;
    }
    .diagnostic-result-mobile .opportunity-title-modern {
      font-size: 1.25rem;
    }
    .diagnostic-result-mobile .opportunity-description-modern {
      font-size: 0.9375rem;
      -webkit-line-clamp: 2;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .diagnostic-result-mobile .opportunity-description-modern.result-expanded {
      -webkit-line-clamp: unset;
      display: block;
    }
    .diagnostic-result-mobile .impact-pills .impact-item-modern {
      padding: 0.5rem 0.75rem;
      font-size: 0.875rem;
    }
    .diagnostic-result-mobile .impact-pills {
      flex-direction: row;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    .diagnostic-result-mobile .consequence-content-modern .consequence-impact-modern {
      font-size: 0.9375rem;
    }
  }

  /* Estilos legacy para compatibilidad */
  .opportunities-section,
  .operational-impact-section,
  .future-vision-section {
    background: #FFFFFF;
    border-radius: 16px;
    padding: 3rem;
    margin-bottom: 3rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }

  .result-section-image {
    width: 100%;
    max-width: 800px;
    height: auto;
    border-radius: 12px;
    margin: 0 auto 2rem;
    display: block;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .section-description {
    font-size: 1.125rem;
    line-height: 1.8;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-bottom: 1.5rem;
  }

  .highlights-list {
    list-style: none;
    padding: 0;
    margin: 1.5rem 0;
  }

  .highlights-list li {
    padding: 0.75rem 0;
    padding-left: 1.5rem;
    position: relative;
    font-size: 1rem;
    line-height: 1.6;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .highlights-list li::before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: #10B981;
    font-weight: 700;
  }

  /* Oportunidades */
  .opportunity-card {
    background: #F6F5F2;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
    display: grid;
    grid-template-columns: 300px 1fr;
    gap: 2rem;
    align-items: start;
  }

  .opportunity-image {
    width: 100%;
    height: auto;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .opportunity-content {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .opportunity-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
  }

  .opportunity-description {
    font-size: 1rem;
    line-height: 1.6;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .opportunity-impact {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-top: 1rem;
  }

  .impact-item {
    font-size: 0.95rem;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .improvement-list {
    list-style: none;
    padding: 0;
    margin: 1rem 0 0;
  }

  .improvement-list li {
    padding: 0.5rem 0;
    padding-left: 1.5rem;
    position: relative;
    font-size: 0.95rem;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .improvement-list li::before {
    content: "‚Üí";
    position: absolute;
    left: 0;
    color: #10B981;
  }

  /* ============================================
     SECCI√ìN: IMPACTO OPERATIVO - DISE√ëO MODERNO
     ============================================ */
  .operational-impact-section-modern {
    margin-bottom: 4rem;
  }

  .operational-impact-title {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(2rem, 4vw, 2.5rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0 0 1.5rem 0;
  }

  .operational-impact-description {
    font-size: clamp(1rem, 1.5vw, 1.125rem);
    line-height: 1.8;
    color: var(--color-grey-medium, #6B7280);
    margin: 0 0 3rem 0;
  }

  .operational-impact-consequences {
    display: flex;
    flex-direction: column;
    gap: 3rem;
  }

  .consequence-card-modern {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0;
    align-items: stretch;
    background: #FFFFFF;
    border-radius: 24px;
    overflow: hidden;
    box-shadow: 
      0 10px 40px rgba(0, 0, 0, 0.08),
      0 2px 8px rgba(0, 0, 0, 0.04);
    min-height: 500px;
  }

  /* Por defecto: texto izquierda, imagen derecha */
  .consequence-card-modern.text-left {
    grid-template-columns: 1fr 1fr;
  }

  /* Alternado: imagen izquierda, texto derecha */
  .consequence-card-modern.image-left {
    grid-template-columns: 1fr 1fr;
  }

  .consequence-content-modern {
    padding: 4rem 3rem;
    display: flex;
    flex-direction: column;
    gap: 2rem;
    background: linear-gradient(135deg, #FFFFFF 0%, #F8F9FA 100%);
    justify-content: center;
    order: 1;
  }

  .consequence-image-wrapper {
    order: 2;
  }

  /* Cuando la imagen va primero (√≠ndice impar) */
  .consequence-card-modern.image-left .consequence-image-wrapper {
    order: 1;
  }

  .consequence-card-modern.image-left .consequence-content-modern {
    order: 2;
  }

  .consequence-area-modern {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.75rem, 3vw, 2.25rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
    line-height: 1.2;
  }

  .consequence-impact-modern {
    font-size: clamp(1rem, 1.5vw, 1.125rem);
    line-height: 1.8;
    color: var(--color-grey-medium, #6B7280);
    margin: 0;
  }

  .consequence-image-wrapper {
    position: relative;
    overflow: hidden;
    background: #F8F9FA;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    min-height: 500px;
    order: 2;
  }

  /* Cuando la imagen va primero (√≠ndice impar) */
  .consequence-card-modern.image-left .consequence-image-wrapper {
    order: 1;
  }

  .consequence-card-modern.image-left .consequence-content-modern {
    order: 2;
  }

  .consequence-image-modern {
    width: 100%;
    height: 100%;
    min-height: 500px;
    object-fit: cover;
    object-position: center;
    display: block;
  }

  /* Responsive */
  @media (max-width: 968px) {
    .consequence-card-modern {
      grid-template-columns: 1fr;
      min-height: auto;
    }

    .consequence-image-wrapper {
      height: 400px;
      order: -1;
      min-height: 400px;
    }

    .consequence-image-modern {
      min-height: 400px;
    }

    .consequence-content-modern {
      padding: 3rem 2rem;
    }
  }

  @media (max-width: 640px) {
    .consequence-image-wrapper {
      height: 300px;
      min-height: 300px;
    }

    .consequence-image-modern {
      min-height: 300px;
    }

    .consequence-content-modern {
      padding: 2rem 1.5rem;
    }
  }

  /* Estilos legacy para compatibilidad */
  .consequence-card {
    background: #FFFFFF;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
    display: grid;
    grid-template-columns: 300px 1fr;
    gap: 2rem;
    align-items: start;
    border-left: 4px solid #2B2B2B;
  }

  .consequence-image {
    width: 100%;
    height: auto;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .consequence-content {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .consequence-area {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
  }

  .consequence-impact {
    font-size: 1rem;
    line-height: 1.6;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  /* ============================================
     SECCI√ìN: VISI√ìN FUTURA - DISE√ëO MODERNO
     ============================================ */
  .future-vision-section-modern {
    margin-bottom: 4rem;
  }

  .future-vision-content {
    display: grid;
    grid-template-columns: 1.2fr 1fr;
    gap: 0;
    align-items: stretch;
    background: #FFFFFF;
    border-radius: 24px;
    padding: 0;
    box-shadow: 
      0 10px 40px rgba(0, 0, 0, 0.08),
      0 2px 8px rgba(0, 0, 0, 0.04);
    overflow: hidden;
    height: calc(100vh - 200px);
    max-height: 800px;
  }

  .future-vision-left {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: stretch;
  }

  .future-vision-image-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: #F8F9FA;
    display: flex;
    align-items: stretch;
  }

  .future-vision-image {
    width: 100%;
    height: 100%;
    display: block;
    object-fit: cover;
    object-position: center;
  }

  .future-vision-text-overlay {
    position: absolute;
    bottom: 2.5rem;
    left: 2.5rem;
    background: #FFFFFF;
    border-radius: 16px;
    padding: 2rem 2.5rem;
    box-shadow: 
      0 12px 32px rgba(0, 0, 0, 0.2),
      0 4px 12px rgba(0, 0, 0, 0.15);
    max-width: 480px;
    width: auto;
    z-index: 2;
  }

  .future-vision-title-overlay {
    font-family: 'Libre Baskerville', serif;
    font-size: clamp(1.5rem, 3vw, 2rem);
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0 0 1rem 0;
    line-height: 1.2;
  }

  .future-vision-description-overlay {
    font-size: clamp(0.9375rem, 1.5vw, 1.0625rem);
    line-height: 1.8;
    color: var(--color-grey-medium, #6B7280);
    margin: 0;
  }

  .future-vision-benefits {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
    align-content: start;
    padding: 2rem;
    height: 100%;
    background: #FFFFFF;
    overflow-y: auto;
  }

  .benefit-card-modern {
    background: #FFFFFF;
    border-radius: 16px;
    padding: 2rem 1.5rem;
    box-shadow: 
      0 4px 12px rgba(0, 0, 0, 0.08),
      0 2px 4px rgba(0, 0, 0, 0.04);
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    height: auto;
    min-height: fit-content;
    box-sizing: border-box;
  }

  .benefit-card-full-width {
    grid-column: 1 / -1;
  }

  .benefit-card-modern:hover {
    transform: translateY(-4px);
    box-shadow: 
      0 8px 20px rgba(0, 0, 0, 0.12),
      0 4px 8px rgba(0, 0, 0, 0.08);
  }

  .benefit-icon-modern {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
    line-height: 1;
  }

  .benefit-title-modern {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin: 0;
    line-height: 1.2;
  }

  .benefit-description-modern {
    font-size: 0.9375rem;
    line-height: 1.6;
    color: var(--color-grey-medium, #6B7280);
    margin: 0;
    flex-grow: 1;
  }

  /* Responsive */
  @media (max-width: 968px) {
    .future-vision-content {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .future-vision-benefits {
      grid-template-columns: repeat(2, 1fr);
      gap: 1.25rem;
    }

    .benefit-card-modern {
      padding: 1.75rem 1.25rem;
      min-height: 180px;
    }
  }

  @media (max-width: 640px) {
    .future-vision-benefits {
      grid-template-columns: 1fr;
    }

    .benefit-card-modern {
      min-height: auto;
    }

    .future-vision-overlay {
      padding: 2rem 1.5rem 1.5rem 1.5rem;
    }
  }

  /* Estilos legacy para compatibilidad */
  .future-vision-section {
    background: #FFFFFF;
    border-radius: 16px;
    padding: 3rem;
    margin-bottom: 3rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }

  .benefits-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
    margin-top: 2rem;
  }

  .benefit-card {
    background: #F6F5F2;
    border-radius: 12px;
    padding: 2rem;
    text-align: center;
  }

  .benefit-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
  }

  .benefit-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-bottom: 0.75rem;
  }

  .benefit-description {
    font-size: 0.95rem;
    line-height: 1.6;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  @media (max-width: 768px) {
    .opportunity-card,
    .consequence-card {
      grid-template-columns: 1fr;
    }

    .opportunity-image,
    .consequence-image {
      max-width: 100%;
    }
  }

  .recommendation-title {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--color-graphite-dark, #2B2B2B);
    margin-bottom: 0.75rem;
  }

  .recommendation-description {
    font-size: 1rem;
    line-height: 1.6;
    color: var(--color-grey-medium, #9A9A97);
    margin-bottom: 1rem;
  }

  .benefits-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .benefits-list li {
    padding: 0.5rem 0;
    padding-left: 1.5rem;
    position: relative;
    font-size: 0.95rem;
    color: var(--color-graphite-dark, #2B2B2B);
  }

  .benefits-list li:before {
    content: '‚úì';
    position: absolute;
    left: 0;
    color: #10B981;
    font-weight: bold;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .diagnostic-result {
      padding: 4rem 1rem 2rem;
    }

    .solution-card-primary {
      padding: 2rem 1.5rem;
    }

    .opportunity-details {
      grid-template-columns: 1fr;
    }

    .solutions-grid {
      grid-template-columns: 1fr;
    }

    .modules-grid {
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    }

    .cta-group {
      flex-direction: column;
    }

    .btn-cta-primary,
    .btn-cta-secondary,
    .btn-cta-tertiary {
      width: 100%;
      text-align: center;
    }

    .cost-comparison {
      flex-direction: column;
      gap: 1rem;
    }

    .arrow {
      transform: rotate(90deg);
    }

    .insight-details {
      grid-template-columns: 1fr;
      gap: 1rem;
    }
  }
</style>

<script>
  // Manejar errores de carga de im√°genes
  document.addEventListener('DOMContentLoaded', () => {
    const images = document.querySelectorAll('.result-section-image, .opportunity-image, .opportunity-image-modern, .consequence-image');
    images.forEach((imgElement) => {
      const img = imgElement as HTMLImageElement;
      img.addEventListener('error', function() {
        console.error('‚ùå Error loading image:', this.src);
        this.style.display = 'none';
      });
      
      // Log cuando la imagen se carga correctamente
      img.addEventListener('load', function() {
        console.log('‚úÖ Image loaded successfully:', this.src);
      });
    });
    
    // Log todas las im√°genes encontradas
    console.log('üîç [CLIENT] Page loaded, checking for diagnostic data...');
    console.log('üîç [CLIENT] Found images:', images.length);
    images.forEach((imgElement, index: number) => {
      const img = imgElement as HTMLImageElement;
      console.log(`üîç [CLIENT] Image ${index + 1}:`, {
        src: img.src,
        alt: img.alt,
        loaded: img.complete,
        naturalWidth: img.naturalWidth,
        naturalHeight: img.naturalHeight
      });
    });
    
    // Buscar mensajes de debug
    const debugMessages = document.querySelectorAll('[style*="background: #fef3c7"]');
    console.log('üîç [CLIENT] Debug messages found:', debugMessages.length);
  });
</script>

<script>
  // Cargar desde localStorage si es necesario (sin recargar la p√°gina)
  document.addEventListener('DOMContentLoaded', () => {
    const placeholder = document.getElementById('diagnostic-loading-placeholder');
    if (placeholder) {
      // Obtener el ID de la URL
      const pathParts = window.location.pathname.split('/');
      const diagnosticId = pathParts[pathParts.length - 1];
      console.log('üì¶ [CLIENT] Loading diagnostic from localStorage:', diagnosticId);
      
      try {
        const stored = localStorage.getItem(`diagnostic-${diagnosticId}`);
        if (stored) {
          const diagnosticData = JSON.parse(stored);
          console.log('‚úÖ [CLIENT] Diagnostic loaded from localStorage:', diagnosticData);
          
          // Asegurar que tenga nextSteps y urgency
          if (!diagnosticData.nextSteps) {
            diagnosticData.nextSteps = {
              primary: {
                text: 'Solicitar consulta personalizada',
                link: '/contacto'
              },
              secondary: {
                text: 'Ver todos los servicios',
                link: '/servicios'
              }
            };
          }
          if (!diagnosticData.urgency) {
            diagnosticData.urgency = 'medium';
          }
          
          // Verificar si ya se intent√≥ recargar para evitar loops infinitos
          const urlParams = new URLSearchParams(window.location.search);
          const hasData = urlParams.get('_hasData') === 'true';
          const reloadAttempted = sessionStorage.getItem(`diagnostic-reload-attempted-${diagnosticId}`);
          
          if (!hasData && !reloadAttempted) {
            // Primera vez: guardar en sessionStorage y recargar con flag
            sessionStorage.setItem('diagnostic-result-data', stored);
            sessionStorage.setItem(`diagnostic-reload-attempted-${diagnosticId}`, 'true');
            const newUrl = `${window.location.pathname}?_hasData=true`;
            window.location.href = newUrl;
            return;
          } else if (hasData) {
            // Ya tiene el flag: leer desde sessionStorage
            const sessionData = sessionStorage.getItem('diagnostic-result-data');
            
            if (sessionData) {
              console.log('‚úÖ [CLIENT] Diagnostic data found in sessionStorage, but server cannot read it.');
              console.log('‚ö†Ô∏è [CLIENT] Need to render content directly from client.');
              
              // Por ahora, simplemente mostrar un mensaje indicando que el diagn√≥stico est√° cargado
              // y que el usuario debe recargar o hacer un nuevo diagn√≥stico
              // En el futuro, aqu√≠ se podr√≠a renderizar todo el contenido directamente
              placeholder.innerHTML = `
                <div style="text-align: center; padding: 4rem 2rem;">
                  <div style="font-size: 3rem; margin-bottom: 1rem;">‚úÖ</div>
                  <h2 style="font-size: 1.5rem; font-weight: 600; color: #0f172a; margin-bottom: 1rem;">
                    Diagn√≥stico cargado
                  </h2>
                  <p style="color: #64748b; margin-bottom: 2rem;">
                    Tu diagn√≥stico se guard√≥ correctamente. Por favor, realiza un nuevo diagn√≥stico para ver los resultados.
                  </p>
                  <a href="/#diagnostico-estrategico" style="
                    display: inline-block;
                    padding: 0.75rem 1.5rem;
                    background: #0f172a;
                    color: #ffffff;
                    text-decoration: none;
                    border-radius: 8px;
                    font-weight: 600;
                    margin-right: 1rem;
                  ">
                    Realizar nuevo diagn√≥stico
                  </a>
                </div>
              `;
              
              // Limpiar sessionStorage
              sessionStorage.removeItem('diagnostic-result-data');
              sessionStorage.removeItem(`diagnostic-reload-attempted-${diagnosticId}`);
              return;
            }
          } else if (reloadAttempted && !hasData) {
            // Ya se intent√≥ recargar pero no funcion√≥, evitar loop infinito
            console.warn('‚ö†Ô∏è [CLIENT] Reload already attempted, preventing infinite loop');
            sessionStorage.removeItem(`diagnostic-reload-attempted-${diagnosticId}`);
          }
        } else {
          console.error('‚ùå [CLIENT] Diagnostic not found in localStorage');
          placeholder.innerHTML = `
            <div style="font-size: 3rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
            <h2 style="font-size: 1.5rem; font-weight: 600; color: #0f172a; margin-bottom: 1rem;">
              Diagn√≥stico no encontrado
            </h2>
            <p style="color: #64748b; margin-bottom: 2rem;">
              No se pudo cargar el diagn√≥stico. Por favor, realiza un nuevo diagn√≥stico.
            </p>
            <a href="/#diagnostico-estrategico" style="
              display: inline-block;
              padding: 0.75rem 1.5rem;
              background: #0f172a;
              color: #ffffff;
              text-decoration: none;
              border-radius: 8px;
              font-weight: 600;
            ">
              Realizar nuevo diagn√≥stico
            </a>
          `;
        }
      } catch (error) {
        console.error('‚ùå [CLIENT] Error loading from localStorage:', error);
        placeholder.innerHTML = `
          <div style="font-size: 3rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
          <h2 style="font-size: 1.5rem; font-weight: 600; color: #0f172a; margin-bottom: 1rem;">
            Error al cargar el diagn√≥stico
          </h2>
          <p style="color: #64748b; margin-bottom: 2rem;">
            Hubo un error al cargar el diagn√≥stico desde el almacenamiento local.
          </p>
          <a href="/#diagnostico-estrategico" style="
            display: inline-block;
            padding: 0.75rem 1.5rem;
            background: #0f172a;
            color: #ffffff;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
          ">
            Realizar nuevo diagn√≥stico
          </a>
        `;
      }
      return;
    }
    
    // Limpiar flags despu√©s de que la p√°gina se haya cargado completamente
    setTimeout(() => {
      sessionStorage.removeItem('diagnostic-result');
      sessionStorage.removeItem(`diagnostic-loaded-${window.location.pathname}`);
    }, 2000);
    
    // Logs del lado del cliente para depuraci√≥n
    console.log('üîç [CLIENT] Page loaded, checking for diagnostic data...');
    
    // Verificar qu√© secciones existen
    const currentSituationSection = document.querySelector('.current-situation-section-modern');
    const opportunitiesSection = document.querySelector('.opportunities-section-modern') || document.querySelector('.opportunities-section');
    const operationalImpactSection = document.querySelector('.operational-impact-section-modern') || document.querySelector('.operational-impact-section');
    const futureVisionSection = document.querySelector('.future-vision-section-modern') || document.querySelector('.future-vision-section');
    const summarySection = document.querySelector('.cost-summary-section-modern') || document.querySelector('.cost-summary-section');
    
    console.log('üîç [CLIENT] Sections found:', {
      currentSituation: !!currentSituationSection,
      opportunities: !!opportunitiesSection,
      operationalImpact: !!operationalImpactSection,
      futureVision: !!futureVisionSection,
      summary: !!summarySection
    });
    
    // Buscar elementos con imageUrl
    const images = document.querySelectorAll('img.result-section-image, img.opportunity-image, img.consequence-image');
    console.log('üîç [CLIENT] Found images:', images.length);
    
    images.forEach((img, index) => {
      const imgElement = img as HTMLImageElement;
      console.log(`üîç [CLIENT] Image ${index + 1}:`, {
        src: imgElement.getAttribute('src'),
        alt: imgElement.getAttribute('alt'),
        class: imgElement.className,
        loaded: imgElement.complete,
        naturalWidth: imgElement.naturalWidth,
        naturalHeight: imgElement.naturalHeight,
        parentSection: imgElement.closest('section, div')?.className
      });
      
      imgElement.addEventListener('error', (e) => {
        console.error(`‚ùå [CLIENT] Image ${index + 1} failed to load:`, imgElement.getAttribute('src'));
      });
      
      imgElement.addEventListener('load', () => {
        console.log(`‚úÖ [CLIENT] Image ${index + 1} loaded successfully:`, imgElement.getAttribute('src'));
      });
    });
    
    // Verificar si hay secciones sin im√°genes
    if (currentSituationSection) {
      const img = currentSituationSection.querySelector('img');
      console.log('üîç [CLIENT] currentSituationSection has image:', !!img, img?.getAttribute('src'));
    }
    if (opportunitiesSection) {
      const imgs = opportunitiesSection.querySelectorAll('img');
      console.log('üîç [CLIENT] opportunitiesSection has images:', imgs.length, Array.from(imgs).map((img: HTMLImageElement) => img.getAttribute('src')));
    }
    if (operationalImpactSection) {
      const imgs = operationalImpactSection.querySelectorAll('img');
      console.log('üîç [CLIENT] operationalImpactSection has images:', imgs.length, Array.from(imgs).map((img: HTMLImageElement) => img.getAttribute('src')));
    }
    if (futureVisionSection) {
      const img = futureVisionSection.querySelector('img');
      console.log('üîç [CLIENT] futureVisionSection has image:', !!img, img?.getAttribute('src'));
    }
    
    // Buscar mensajes de debug
    const debugMessages = document.querySelectorAll('[style*="background: #fef3c7"]');
    console.log('üîç [CLIENT] Debug messages found:', debugMessages.length);
    debugMessages.forEach((msg, index) => {
      console.log(`üîç [CLIENT] Debug message ${index + 1}:`, msg.textContent);
    });

    // Funcionalidad del slider de oportunidades con autoplay
    const opportunitiesSlider = document.getElementById('opportunities-slider');
    const opportunityPrev = document.getElementById('opportunity-prev');
    const opportunityNext = document.getElementById('opportunity-next');
    const opportunityIndicators = document.querySelectorAll('.opportunity-indicator');
    const opportunitySlides = document.querySelectorAll('.opportunity-slide');

    if (opportunitiesSlider && opportunitySlides.length > 0) {
      let currentSlide = 0;
      const totalSlides = opportunitySlides.length;
      let autoplayInterval: number | null = null;
      const autoplayDelay = 5000; // 5 segundos

      console.log('üé† [OPPORTUNITIES SLIDER] Initialized:', {
        totalSlides,
        sliderElement: !!opportunitiesSlider,
        prevBtn: !!opportunityPrev,
        nextBtn: !!opportunityNext,
        indicators: opportunityIndicators.length
      });

      const updateSlider = () => {
        if (!opportunitiesSlider) return;
        
        const sliderElement = opportunitiesSlider as HTMLElement;
        const wrapper = sliderElement.parentElement;
        if (!wrapper) return;

        const wrapperWidth = wrapper.offsetWidth;
        const translateX = -currentSlide * wrapperWidth;
        
        sliderElement.style.transform = `translateX(${translateX}px)`;
        sliderElement.style.display = 'flex';
        sliderElement.style.width = `${totalSlides * 100}%`;

        // Asegurar que cada slide tenga el ancho correcto
        opportunitySlides.forEach((slide) => {
          const slideElement = slide as HTMLElement;
          slideElement.style.width = `${wrapperWidth}px`;
          slideElement.style.minWidth = `${wrapperWidth}px`;
          slideElement.style.maxWidth = `${wrapperWidth}px`;
          slideElement.style.flexShrink = '0';
          slideElement.style.flexGrow = '0';
          slideElement.style.flexBasis = `${wrapperWidth}px`;
        });

        console.log('üé† [OPPORTUNITIES SLIDER] Updated:', {
          currentSlide,
          translateX,
          totalSlides,
          wrapperWidth
        });

        // Actualizar indicadores
        opportunityIndicators.forEach((indicator, index) => {
          if (index === currentSlide) {
            indicator.classList.add('active');
          } else {
            indicator.classList.remove('active');
          }
        });

        // Actualizar botones
        if (opportunityPrev) {
          (opportunityPrev as HTMLButtonElement).disabled = false;
        }
        if (opportunityNext) {
          (opportunityNext as HTMLButtonElement).disabled = false;
        }
      };

      const nextSlide = () => {
        currentSlide = (currentSlide + 1) % totalSlides;
        updateSlider();
      };

      const prevSlide = () => {
        currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
        updateSlider();
      };

      const startAutoplay = () => {
        if (autoplayInterval) {
          clearInterval(autoplayInterval);
        }
        autoplayInterval = window.setInterval(() => {
          nextSlide();
        }, autoplayDelay);
      };

      const stopAutoplay = () => {
        if (autoplayInterval) {
          clearInterval(autoplayInterval);
          autoplayInterval = null;
        }
      };

      if (opportunityPrev) {
        opportunityPrev.addEventListener('click', () => {
          prevSlide();
          startAutoplay(); // Reiniciar autoplay despu√©s de interacci√≥n manual
        });
      }

      if (opportunityNext) {
        opportunityNext.addEventListener('click', () => {
          nextSlide();
          startAutoplay(); // Reiniciar autoplay despu√©s de interacci√≥n manual
        });
      }

      opportunityIndicators.forEach((indicator, index) => {
        indicator.addEventListener('click', () => {
          currentSlide = index;
          updateSlider();
          startAutoplay(); // Reiniciar autoplay despu√©s de interacci√≥n manual
        });
      });

      // Pausar autoplay al hacer hover
      const sliderWrapper = opportunitiesSlider.closest('.opportunities-slider-wrapper');
      if (sliderWrapper) {
        sliderWrapper.addEventListener('mouseenter', stopAutoplay);
        sliderWrapper.addEventListener('mouseleave', startAutoplay);
      }

      // Touch/swipe support
      let startX = 0;
      let isDragging = false;

      opportunitiesSlider.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
        isDragging = true;
        stopAutoplay();
      });

      opportunitiesSlider.addEventListener('touchmove', (e) => {
        if (!isDragging) return;
        e.preventDefault();
      });

      opportunitiesSlider.addEventListener('touchend', (e) => {
        if (!isDragging) return;
        isDragging = false;
        const endX = e.changedTouches[0].clientX;
        const diff = startX - endX;

        if (Math.abs(diff) > 50) {
          if (diff > 0) {
            nextSlide();
          } else {
            prevSlide();
          }
        }
        startAutoplay();
      });

      // Mouse drag support
      let mouseStartX = 0;
      let isMouseDragging = false;

      opportunitiesSlider.addEventListener('mousedown', (e) => {
        mouseStartX = e.clientX;
        isMouseDragging = true;
        (opportunitiesSlider as HTMLElement).style.cursor = 'grabbing';
        stopAutoplay();
      });

      opportunitiesSlider.addEventListener('mousemove', (e) => {
        if (!isMouseDragging) return;
        e.preventDefault();
      });

      opportunitiesSlider.addEventListener('mouseup', (e) => {
        if (!isMouseDragging) return;
        isMouseDragging = false;
        (opportunitiesSlider as HTMLElement).style.cursor = 'grab';
        const mouseEndX = e.clientX;
        const mouseDiff = mouseStartX - mouseEndX;

        if (Math.abs(mouseDiff) > 50) {
          if (mouseDiff > 0) {
            nextSlide();
          } else {
            prevSlide();
          }
        }
        startAutoplay();
      });

      opportunitiesSlider.style.cursor = 'grab';

      // Inicializar despu√©s de que la p√°gina cargue completamente
      setTimeout(() => {
        updateSlider();
        if (totalSlides > 1) {
          startAutoplay(); // Iniciar autoplay autom√°ticamente solo si hay m√°s de un slide
        }
      }, 100);

      // Actualizar al redimensionar
      window.addEventListener('resize', () => {
        updateSlider();
      });
    } else {
      console.warn('üé† [OPPORTUNITIES SLIDER] Not initialized:', {
        slider: !!opportunitiesSlider,
        slides: opportunitySlides.length
      });
    }
  });
</script>